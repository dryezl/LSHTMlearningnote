

本章的練習，我們主要使用四個計算似然的命令來加深我們對似然這一概念的理解：

- `blik`: binomial likelihood （二項分佈的似然）
- `plik`: Poisson likelihood （泊松分佈的似然）
- `bloglik`: binomial log-likelihood （二項分佈的對數似然）
- `ploglik`: Poisson log-likelihood （泊松分佈的對數似然）


## Q1 二項分佈似然的圖形

在R語言中繪製二項分佈參數 $\pi$ 在不同情況下的似然函數圖： 


1. 10次實驗中4次失敗：

```{r binomL4, cache=TRUE, fig.width=6, fig.height=5, echo = TRUE, fig.cap='Binomial(10, 4) Likelihood ratio ', fig.align='center', out.width='90%'}
x <- seq(0,1,by=0.001)
y <- (x^4)*((1-x)^6) / (0.4^4*0.6^6)
plot(x, y, type = "l", ylab = "LR(\U03C0)", xlab = "\U03C0")
abline(v=0.4, lty=2)
abline(h=1.0, lty=2)
abline(h=0.1466, lty=2, lwd = 2, col = "red")
```

2，100次實驗中40次失敗：

```{r binomL40, cache=TRUE, fig.width=6, fig.height=5, echo = TRUE, fig.cap='Binomial(100, 40) Likelihood ratio', fig.align='center', out.width='90%'}
x <- seq(0,1,by=0.001)
y <- (x^40)*((1-x)^60) / (0.4^40*0.6^60)
plot(x, y, type = "l", ylab = "LR(\U03C0)", xlab = "\U03C0")
abline(h=1.0, lty=2)
abline(v=0.4, lty=2)
abline(h=0.1466, lty=2, lwd = 2, col = "red")

```

3. 1000 次實驗中 400 次失敗：

```{r binomL400, cache=TRUE, fig.width=6, fig.height=5, echo = TRUE, fig.cap='Binomial(1000, 400) Likelihood ratio', fig.align='center', out.width='90%'}
x <- seq(0,1,by=0.001)
y <- (x^400)*((1-x)^600) / (0.4^400*0.6^600)
plot(x, y, type = "l", ylab = "LR(\U03C0)", xlab = "\U03C0")
abline(v=0.4, lty=2)
abline(h=1.0, lty=2)
abline(h=0.1466, lty=2, lwd = 2, col = "red")
```


三個圖的整體信息告訴我們，數據越多，對參數的估計越精確 (more data more precise estimate)。


## Q2 修改信賴區間的寬度

把紅線刻度從 0.1466 改成 0.2585，會發生怎樣的改變？


```{r binomL401, cache=TRUE, fig.width=6, fig.height=5, echo = TRUE, fig.cap='Binomial(100, 40) Likelihood ratio, with 90% CI.', fig.align='center', out.width='90%'}
x <- seq(0,1,by=0.001)
y <- (x^40)*((1-x)^60) / (0.4^40*0.6^60)
plot(x, y, type = "l", ylab = "LR(\U03C0)", xlab = "\U03C0")
abline(h=1.0, lty=2)
abline(v=0.4, lty=2)
abline(h=0.2585, lty=2, lwd = 2, col = "red")
```
當改成使用 90% 信賴區間的時候，區間變窄，但其實我們對這個區間的長期重複實驗結果是否包含真實參數值的信心變小了。(less confident about the interval)

## Q3 嘗試繪製一些極端情況下的似然函數圖

1. 假如繪製如 10 次實驗中 1 次失敗的二項分佈參數似然函數圖：

```{r binomL19, cache=TRUE, fig.width=6, fig.height=5, echo = TRUE, fig.cap='Binomial(10, 1) Likelihood ratio ', fig.align='center', out.width='90%'}
x <- seq(0,1,by=0.001)
y <- (x^1)*((1-x)^9) / (0.1^1*0.9^9)
plot(x, y, type = "l", ylab = "LR(\U03C0)", xlab = "\U03C0")
abline(v=0.1, lty=2)
abline(h=1.0, lty=2)
abline(h=0.1466, lty=2, lwd = 2, col = "red")
```
2. 假如繪製如 100 次實驗中 1 次失敗的二項分佈參數似然函數圖：

```{r binomL199, cache=TRUE, fig.width=6, fig.height=5, echo = TRUE, fig.cap='Binomial(100, 1) Likelihood ratio ', fig.align='center', out.width='90%'}
x <- seq(0,1,by=0.001)
y <- (x^1)*((1-x)^99) / (0.01^1*0.99^99)
plot(x, y, type = "l", ylab = "LR(\U03C0)", xlab = "\U03C0")
abline(v=0.01, lty=2)
abline(h=1.0, lty=2)
abline(h=0.1466, lty=2, lwd = 2, col = "red")
```

當實驗結果或數據較爲極端的時候，我們發現似然比不再和正（常）態分佈近似，也越來越偏向一邊。(no longer symmertrical and bell-shaped with extreme splits)


## Q4 失敗次數爲 0 會發生什麼


當多次實驗中觀察到 0 次失敗，那麼似然函數會變成怎樣？




1. 10次實驗中0次失敗：

```{r binomL0, cache=TRUE, fig.width=6, fig.height=5, echo = FALSE, fig.cap='Binomial(10, 4) Likelihood ratio ', fig.align='center', out.width='90%'}
x <- seq(0,1,by=0.001)
y <- (x^0)*((1-x)^10) / (0.0^0*1^10)
plot(x, y, type = "l", ylab = "LR(\U03C0)", xlab = "\U03C0")
# abline(v=0.4, lty=2)
abline(h=1.0, lty=2)
abline(h=0.1466, lty=2, lwd = 2, col = "red")
```

2，100次實驗中0次失敗：

```{r binomL10, cache=TRUE, fig.width=6, fig.height=5, echo = FALSE, fig.cap='Binomial(100, 40) Likelihood ratio', fig.align='center', out.width='90%'}
x <- seq(0,1,by=0.001)
y <- (x^0)*((1-x)^100) / (0^0*1^100)
plot(x, y, type = "l", ylab = "LR(\U03C0)", xlab = "\U03C0")
abline(h=1.0, lty=2)
# abline(v=0.4, lty=2)
abline(h=0.1466, lty=2, lwd = 2, col = "red")

```

3. 1000 次實驗中 0 次失敗：

```{r binomL100, cache=TRUE, fig.width=6, fig.height=5, echo = FALSE, fig.cap='Binomial(1000, 400) Likelihood ratio', fig.align='center', out.width='90%'}
x <- seq(0,1,by=0.001)
y <- (x^0)*((1-x)^1000) / (0^0*1^1000)
plot(x, y, type = "l", ylab = "LR(\U03C0)", xlab = "\U03C0")
# abline(v=0.4, lty=2)
abline(h=1.0, lty=2)
abline(h=0.1466, lty=2, lwd = 2, col = "red")
```

於是我們知道當沒有失敗時，二項分佈數據的參數 $\pi$ 的似然函數沒有轉折點。(no turning point)


## Q5 泊松分佈參數的似然函數


在R語言中繪製泊松分佈參數 $\lambda$ 在不同情況下的似然函數圖： 


1. 500人年的觀察中發現7人死亡：

```{r poissonL4, cache=TRUE, fig.width=6, fig.height=5, echo = TRUE, fig.cap='Poisson Likelihood ratio for rate parameter D = 7, Y = 500', fig.align='center', out.width='90%'}
x <- seq(0, 40, by=0.1)/1000
y <- exp( -500 * x + 7 + 7 * log( x * 500)  - 7 * log(7))
plot(x, y, type = "l", ylab = "LR(\u03BB)", xlab = ~lambda)
abline(h=1.0, lty=2)
abline(h=0.1466, lty=2, lwd = 2, col = "red")
```
`
2，5000人年的觀察中發現70人死亡：

```{r poissonL40, cache=TRUE, fig.width=6, fig.height=5, echo = TRUE, fig.cap='Poisson Likelihood ratio for rate parameter D = 70, Y = 5000', fig.align='center', out.width='90%'}
x <- seq(0, 40, by=0.01)/1000
y <- exp( -5000 * x + 70 + 70 * log( x * 5000)  - 70 * log(70))
plot(x, y, type = "l", ylab = "LR(\u03BB)", xlab = ~lambda)
abline(h=1.0, lty=2)
abline(v=0.4, lty=2)
abline(h=0.1466, lty=2, lwd = 2, col = "red")

```

3，5000人年的觀察中發現700人死亡：

```{r poissonL400, cache=TRUE, fig.width=6, fig.height=5, echo = TRUE, fig.cap='Poisson Likelihood ratio for rate parameter D = 700, Y = 50000', fig.align='center', out.width='90%'}
x <- seq(0, 40, by=0.01)/1000
y <- exp( -50000 * x + 700 + 700 * log( x * 50000)  - 700 * log(700))
plot(x, y, type = "l", ylab = "LR(\u03BB)", xlab = ~lambda)
abline(v=0.4, lty=2)
abline(h=1.0, lty=2)
abline(h=0.1466, lty=2, lwd = 2, col = "red")
```


三個圖的整體信息仍然告訴我們，數據越多，對參數的估計越精確 (more data more precise estimate)。

